"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1);var u=navigator.userAgent,isAndroid=-1<u.indexOf("Android")||-1<u.indexOf("Adr"),isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);function getUrlParams(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i"),r=unescape(window.location.search).substr(1).match(reg);return null!=r?unescape(r[2]):null}isAndroid?$("head").append('<link rel="stylesheet" type="text/css" href="./css/productInfoAd.css"/>'):isiOS&&($("head").append('<link rel="stylesheet" type="text/css" href="./css/productInfo.css"/>'),812==screen.height&&375==screen.width&&$("#main").css("padding-bottom","2.67rem"));var userID=getUrlParams("userId"),itemId=getUrlParams("itemId"),coupon=getUrlParams("coupon"),commission=getUrlParams("commission"),itemUrl=getUrlParams("itemUrl"),tmall=getUrlParams("tmall"),nativeUrl=getUrlParams("nativeUrl");function goodsShare(e){var data=JSON.stringify(e.data),u=navigator.userAgent,isAndroid=-1<u.indexOf("Android")||-1<u.indexOf("Adr"),isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);isAndroid?window.jsi.goodsShare(data):isiOS&&window.webkit.messageHandlers.goodsShare.postMessage(data)}function vouchers(e){console.log(e.data);var data=JSON.stringify(e.data),u=navigator.userAgent,isAndroid=-1<u.indexOf("Android")||-1<u.indexOf("Adr"),isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);isAndroid?window.jsi.vouchers(data):isiOS&&window.webkit.messageHandlers.vouchers.postMessage(data)}function goodsInfo(){var goodsInfoAPIUrl='select * from json where url="https://acs.m.taobao.com/h5/mtop.taobao.detail.getdetail/6.0/?data=%7B%22itemNumId%22%3A%22'+itemId+'%22%7D&qq-pf-to=pcqq.group"';$.ajax({url:"http://query.yahooapis.com/v1/public/yql",dataType:"jsonp",data:{q:goodsInfoAPIUrl,format:"json"},success:function(d){console.log("detail1",d);var goodsInfoAPI=d.query.results.json.data.item.moduleDescUrl;goodsInfoAPI=goodsInfoAPI.substring(2),$.ajax({url:"http://query.yahooapis.com/v1/public/yql",dataType:"jsonp",data:{q:'select * from json where url="http://'+goodsInfoAPI+'"',format:"json"},success:function(d){var goodsInfo=d.query.results.json.data,reg=/^(detail_pic_)/;goodsInfo.children.filter(function(v){return reg.test(v.ID)}).map(function(item){$(".goodsInfo").append('<img class="lazyload" data-src="'+item.params.picUrl+'_600x600q90.jpg" />')}),lazyload()},error:function(_error){goodsInfo()}})},error:function(_error2){goodsInfo()}})}function Ajax(type,url,data,success,failed){var xhr=null;xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");type=type.toUpperCase();var random=Math.random();if("object"==(void 0===data?"undefined":_typeof(data))){var str="";for(var key in data)str+=key+"="+data[key]+"&";data=str.replace(/&$/,"")}"GET"==type?(data?xhr.open("GET",url+"?"+data,!0):xhr.open("GET",url+"?t="+random,!0),xhr.send()):"POST"==type&&(xhr.open("POST",url,!0),xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhr.send(data)),xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status?success(xhr.responseText):failed&&failed(xhr.status))}}console.table({userId:userID,itemId:itemId,coupon:coupon,commission:commission,itemUrl:itemUrl,tmall:tmall,nativeUrl:nativeUrl}),ajaxUrl="https://zhishun520.com/toutiaotv-api-home-1.0.0",$.ajax({url:ajaxUrl+"/get/tao/product/",type:"GET",dataType:"json",data:{itemId:itemId,userId:userID,random:Math.random()},success:function(data){var _$$on;if("true"===data.result.success||"5946"!=userID){$(".goods").show(),coupon=getUrlParams("coupon"),commission=getUrlParams("commission"),itemUrl="",tmall=getUrlParams("tmall"),nativeUrl=getUrlParams("nativeUrl");var bannerImg=(data=data.data).itemPicUrl,name=data.name,itemPrice=parseFloat(data.itemPrice),itemPicUrl=data.itemPicUrl,sales=data.sales,commission=null==commission||""==commission?data.commission:commission,nativeUrl=null==nativeUrl||""==nativeUrl?data.nativeUrl:nativeUrl,itemUrl=null==itemUrl||""==itemUrl?data.itemUrl:itemUrl,coupon=null==coupon||""==coupon?data.coupon:coupon,tmall=null==tmall||""==tmall?data.tmall:tmall;$(".banner").css("background-image","url("+bannerImg+"_600x600q90.jpg)"),$(".vouchers").html("领"+coupon+"元券购买"),$(".tip").html("购买后返"+commission+"元"),$(".price").html((itemPrice-coupon).toFixed(2)),0==tmall?($(".itemPrice").html("淘宝价:￥<span style='text-decoration:line-through;'>"+itemPrice+"</span>"),$(".goodsName").html('\n\t\t\t<img src="./img/type_taobaol_icon.png" alt="" />'+name+" \n\t\t\t")):($(".itemPrice").html("天猫价:￥<span style='text-decoration:line-through;'>"+itemPrice+"</span>"),$(".goodsName").html('\n\t\t\t<img src="./img/type_tmall_icon.png" alt="" />'+name+" \n\t\t\t")),$(".quantity").html("已售  "+sales),$(".goodsShare").html("分享"),$(".goodsShare").on("click",(_defineProperty(_$$on={picUrl:bannerImg[0],itemId:itemId,nativeUrl:nativeUrl,itemUrl:itemUrl},"itemId",itemId),_defineProperty(_$$on,"coupon",coupon.toString()),_defineProperty(_$$on,"commission",commission.toString()),_defineProperty(_$$on,"itemPrice",itemPrice.toString()),_defineProperty(_$$on,"name",name),_defineProperty(_$$on,"sales",sales.toString()),_defineProperty(_$$on,"itemPicUrl",itemPicUrl),_defineProperty(_$$on,"tmall",tmall),_$$on),goodsShare),$(".vouchers").on("click",{nativeUrl:nativeUrl,itemUrl:itemUrl,itemId:itemId,itemPrice:itemPrice.toString(),name:name,coupon:coupon.toString(),sales:sales.toString(),itemPicUrl:itemPicUrl,tmall:tmall},vouchers),goodsInfo()}else $("body").html(JSON.stringify(data))},error:function(err){"5946"!=userID||$("body").html(JSON.stringify(err))}});